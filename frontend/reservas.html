    <!DOCTYPE html>
    <html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Reservas Activas - Gestor de Reservas</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
        <style>
            body { font-family: 'Inter', sans-serif; }
            /* Estilo para la tabla pegajosa */
            .table-container { max-height: 70vh; }
            thead th { position: sticky; top: 0; z-index: 1; }
        </style>
    </head>
    <body class="bg-gray-100">

        <div class="min-h-screen">
            <!-- Barra de Navegación Superior -->
            <nav class="bg-white shadow-sm">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex items-center justify-between h-16">
                        <a href="dashboard.html" class="text-xl font-bold text-gray-800">Gestor de Reservas</a>
                        <div id="auth-info" class="flex items-center space-x-4"></div>
                    </div>
                </div>
            </nav>

            <!-- Contenido Principal -->
            <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
                <div class="bg-white p-6 md:p-8 rounded-lg shadow">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-semibold text-gray-900">Listado de Reservas</h2>
                        <input type="text" id="search-input" placeholder="Buscar por nombre, canal, estado..." class="mt-4 md:mt-0 w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    
                    <!-- Contenedor de la tabla con scroll -->
                    <div class="table-container overflow-y-auto border rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Canal</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre Cliente</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Llegada</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Salida</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                                </tr>
                            </thead>
                            <tbody id="reservas-table-body" class="bg-white divide-y divide-gray-200">
                                <!-- Las filas se insertarán aquí dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                    <div id="loading-state" class="text-center p-8">
                        <p class="text-gray-500">Cargando reservas...</p>
                    </div>
                </div>
            </main>
        </div>

        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
            import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js";

            // --- Configuración ---
            const API_BASE_URL = 'https://gestor-reservas.onrender.com'; // URL de tu API en Render
            const firebaseConfig = {
                apiKey: "AIzaSyC_9_hrjyOLnBIARguITiY80Eg1riKjdCE",
                authDomain: "reservas-sodc.firebaseapp.com",
                projectId: "reservas-sodc",
                storageBucket: "reservas-sodc.appspot.com",
                messagingSenderId: "17783383809",
                appId: "1:17783383809:web:329694a3dc2df074f7d800"
            };

            // --- Inicialización ---
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);

            // --- Elementos del DOM ---
            const authInfo = document.getElementById('auth-info');
            const reservasTableBody = document.getElementById('reservas-table-body');
            const loadingState = document.getElementById('loading-state');
            const searchInput = document.getElementById('search-input');
            
            let allReservas = []; // Almacenará todas las reservas para filtrar

            // --- Funciones ---

            /**
             * Renderiza las filas de la tabla de reservas.
             * @param {Array} reservas - El array de reservas a mostrar.
             */
            function renderTable(reservas) {
                reservasTableBody.innerHTML = ''; // Limpia la tabla
                if (reservas.length === 0) {
                    loadingState.innerHTML = '<p class="text-gray-500">No se encontraron reservas.</p>';
                    loadingState.style.display = 'block';
                    return;
                }
                
                loadingState.style.display = 'none';

                reservas.forEach(reserva => {
                    const row = document.createElement('tr');
                    row.className = "hover:bg-gray-50";
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${reserva.canal || 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${reserva.nombre || 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${reserva.llegada || 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${reserva.salida || 'N/A'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${reserva.estado || 'N/A'}</td>
                    `;
                    reservasTableBody.appendChild(row);
                });
            }

            /**
             * Obtiene las reservas desde la API y las muestra.
             */
            async function loadReservas() {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/reservas`);
                    if (!response.ok) throw new Error(`Error HTTP: ${response.status}`);
                    
                    allReservas = await response.json();
                    renderTable(allReservas);

                } catch (error) {
                    console.error('Error al cargar las reservas:', error);
                    loadingState.innerHTML = '<p class="text-red-500 font-semibold">No se pudieron cargar las reservas. Revisa la consola.</p>';
                }
            }

            // --- Lógica de Autenticación y Eventos ---

            onAuthStateChanged(auth, (user) => {
                if (user) {
                    authInfo.innerHTML = `
                        <span class="text-sm text-gray-600 hidden sm:block">${user.email}</span>
                        <button id="logout-btn" class="px-3 py-2 bg-red-600 text-white text-xs font-medium rounded-md hover:bg-red-700">Cerrar Sesión</button>
                    `;
                    document.getElementById('logout-btn').addEventListener('click', () => signOut(auth));
                    
                    // Carga los datos solo si el usuario está autenticado
                    loadReservas();
                } else {
                    window.location.href = 'index.html';
                }
            });

            // Evento para el filtro de búsqueda
            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filteredReservas = allReservas.filter(r => 
                    (r.nombre && r.nombre.toLowerCase().includes(searchTerm)) ||
                    (r.canal && r.canal.toLowerCase().includes(searchTerm)) ||
                    (r.estado && r.estado.toLowerCase().includes(searchTerm))
                );
                renderTable(filteredReservas);
            });
        </script>
    </body>
    </html>
    